# WaveMesh-Diff Configuration Template
# This file will be used for training and inference

# Wavelet Transform Settings
wavelet:
  type: "bior4.4" # Wavelet family (bior4.4, db4, coif3, etc.)
  level: 3 # Decomposition levels (2-5)
  threshold: 0.01 # Sparsification threshold
  adaptive_threshold: false # Use adaptive thresholding

# Data Processing
data:
  resolution: 256 # SDF grid resolution
  padding: 0.1 # Mesh normalization padding
  batch_size: 4 # Training batch size
  num_workers: 4 # DataLoader workers
  cache_sdf: true # Cache SDF grids to disk

# Model Architecture (Module B - Sparse U-Net)
model:
  # Encoder
  encoder_channels: [32, 64, 128, 256]
  encoder_strides: [2, 2, 2, 2]

  # Decoder
  decoder_channels: [256, 128, 64, 32]

  # Attention
  use_attention: true
  attention_heads: 8
  attention_dim: 64

  # Conditioning
  image_feature_dim: 768 # DINOv2 output dim
  num_views: 4 # Number of input views

  # Sparse Conv Settings
  use_subm: true # Submanifold sparse convolution

# Diffusion Settings (Module C)
diffusion:
  timesteps: 1000 # Number of diffusion steps
  beta_schedule: "linear" # linear, cosine, sqrt
  beta_start: 0.0001
  beta_end: 0.02

  # Sampling
  ddim_steps: 50 # DDIM sampling steps
  eta: 0.0 # DDIM eta parameter

  # Classifier-free guidance
  cfg_scale: 3.0 # Guidance scale
  cfg_dropout: 0.1 # Conditioning dropout

# Training
training:
  epochs: 500
  learning_rate: 1.0e-4
  weight_decay: 0.01
  lr_scheduler: "cosine" # cosine, step, plateau
  warmup_epochs: 10

  # Losses
  loss_type: "l2" # l1, l2, huber

  # Checkpointing
  save_every: 10 # Save checkpoint every N epochs
  validate_every: 5 # Validate every N epochs

  # Logging
  log_every: 100 # Log every N steps
  use_wandb: true
  project_name: "wavemesh-diff"

# Multi-view Encoder (Module D)
encoder:
  model: "dinov2_vitb14" # DINOv2 model variant
  freeze: true # Freeze encoder weights
  camera_embed_dim: 64 # Camera pose embedding dimension

# Hardware
device: "cuda" # cuda, cpu
mixed_precision: true # Use automatic mixed precision
compile: false # Torch 2.0 compile (experimental)

# Paths
paths:
  data_root: "./data/meshes"
  output_dir: "./outputs"
  checkpoint_dir: "./checkpoints"
  log_dir: "./logs"

# Evaluation
eval:
  metrics: ["chamfer", "f1_score", "volume_iou"]
  num_samples: 1000 # Points for Chamfer distance
  threshold: 0.01 # F-Score threshold
